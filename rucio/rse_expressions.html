

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RSE Expressions &mdash; Rucio 1.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Accounting and quota" href="overview_Accounting_and_quota.html" />
    <link rel="prev" title="Replication rule examples" href="replication_rules_examples.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Rucio
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts and terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="replica_workflow.html">Typical replica workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="releasepolicy.html">Release policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="releasenotes.html">Release notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing.html">Setting up a Rucio development environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest.html">RESTful APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">The Client API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database operations</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installing_clients.html">Installing Rucio Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_examples.html">Rucio CLI: Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="man/rucio.html">Rucio CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="man/rucio-admin.html">Rucio Administrative CLI</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">RSE Expressions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#simple-rse-expressions">Simple RSE Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#composing-rse-expressions">Composing RSE Expressions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="clients.html">Rucio Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="clients.html#errors-and-exceptions">Errors and Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage.html">Advanced Usage</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installing_server.html">Installing Rucio server</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing_daemons.html">Installing Rucio daemons</a></li>
<li class="toctree-l1"><a class="reference internal" href="man/daemons.html">Daemons CLIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring.html">Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy_packages.html">Policy packages</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="demo_environment.html">Setting up a Rucio development environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_examples.html">Rucio CLI: Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_admin_examples.html">Rucio administration CLI: Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Individual contributors to the source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html#organisations-employing-contributors">Organisations employing contributors</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Rucio</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="concepts.html">Concepts and terminology</a> &raquo;</li>
        
      <li>RSE Expressions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rse_expressions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rse-expressions">
<h1>RSE Expressions<a class="headerlink" href="#rse-expressions" title="Permalink to this headline">¶</a></h1>
<p>An <strong>RSE Expression</strong> allows to select a set of RSEs, for example to create replication rules.
The RSE Expression consists of one or more <strong>terms</strong>. A term can be a single RSE name or a condition over the RSE attributes.
The RSE Expression Parser resolves each term to a set of RSEs. Terms can be connected by <strong>operators</strong> to form more complex expressions.
For example, users can write RSE expressions to address all Tier 2 RSEs, all the RSEs in certain cloud, all Tier 2 RSEs not in certain clouds, etc.</p>
<div class="section" id="simple-rse-expressions">
<h2>Simple RSE Expressions<a class="headerlink" href="#simple-rse-expressions" title="Permalink to this headline">¶</a></h2>
<p>Rucio allows to test RSE Expressions, using the command <strong>list-rses</strong>. The most simple RSE Expression is the one containing the name of a particular RSE.</p>
<ol class="arabic">
<li><p>The following expression returns all RSEs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0058:~$ rucio list-rses --expression &#39;*&#39;
IFIC-LCG2_LOCALGROUPDISK
IFAE_PRODDISK
PIC_SCRATCHDISK
EELA-UNLP_SCRATCHDISK
CERN-PROD_TZDISK
BNL-OSG2_MCTAPE
BNL-OSG2_DATADISK
IN2P3-CC_MCTAPE
CERN-PROD_DERIVED
CERN-PROD_DATADISK
EELA-UNLP_DATADISK
UAM-LCG2_SCRATCHDISK
IFIC-LCG2_DATADISK
LIP-COIMBRA_LOCALGROUPDISK
...
</pre></div>
</div>
</li>
<li><p>Whereas the next expression only returns a set containing a single RSE:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0058:~$ rucio list-rses --expression EELA-UNLP_SCRATCHDISK
EELA-UNLP_SCRATCHDISK
</pre></div>
</div>
</li>
<li><p>Another simple RSE Expression allows to list the set of all the RSEs in a particular site:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0058:~$ rucio list-rses --expression site=EELA-UNLP
EELA-UNLP_PRODDISK
EELA-UNLP_DATADISK
EELA-UNLP_SCRATCHDISK
</pre></div>
</div>
</li>
<li><p>Or all the RSEs who’s type is SCRATCHDISK:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0058:~$ rucio list-rses --expression type=SCRATCHDISK
UNI-SIEGEN-HEP_SCRATCHDISK
NCG-INGRID-PT_SCRATCHDISK
EELA-UNLP_SCRATCHDISK
...
INFN-T1_SCRATCHDISK
FMPHI-UNIBA_SCRATCHDISK
INFN-FRASCATI_SCRATCHDISK
</pre></div>
</div>
</li>
<li><p>Or all the Spanish sites:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0058:~$ rucio list-rses --expression SPAINSITES
IFIC-LCG2_LOCALGROUPDISK
IFAE_PRODDISK
PIC_SCRATCHDISK
EELA-UNLP_SCRATCHDISK
...
EELA-UNLP_DATADISK
UAM-LCG2_SCRATCHDISK
IFIC-LCG2_DATADISK
LIP-COIMBRA_LOCALGROUPDISK
</pre></div>
</div>
</li>
<li><p>Also numerical comparisons with &lt; and &gt; are possible:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0058:~$ rucio list-rses --expression &quot;freespace&gt;3000&quot;
CERN-PROD_TZDISK
BNL-OSG2_MCTAPE
BNL-OSG2_DATADISK
IN2P3-CC_MCTAPE
CERN-PROD_DERIVED
CERN-PROD_DATADISK
</pre></div>
</div>
</li>
</ol>
<p>Note that if the RSE Expression returns an empty set, Rucio returns an error as an RSE Expression must resolve to at least one RSE. Thus, an error does not necessarily mean that the syntax of the expression is wrong, it might just result into an empty list.</p>
<p>In 3) and 4), the RSE Expression refers to an attribute in the RSE that must be equal to a given value to match the expression.
While in 2) and 5), the expression matches an RSE if the attribute is True. In 6) a numerical term is used to resolve all RSEs with more than 3000 TB free space.
It is possible to see the list of attributes for a particular RSE with Rucio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0100:~$ rucio list-rse-attributes EELA-UNLP_SCRATCHDISK
  ftstesting: https://fts3-pilot.cern.ch:8446
  ALL: True
  ESTIER2S: True
  physgroup: None
  spacetoken: ATLASSCRATCHDISK
  fts: https://fts3.cern.ch:8446,https://lcgfts3.gridpp.rl.ac.uk:8446,https://fts.usatlas.bnl.gov:8446
  site: EELA-UNLP
  EELA-UNLP_SCRATCHDISK: True
  datapolicyt0disk: False
  cloud: ES
  SPAINSITES: True
  datapolicyt0taskoutput: False
  fts_testing: https://fts3-pilot.cern.ch:8446
  tier: 3
  datapolicyt0tape: False
  type: SCRATCHDISK
  istape: False
</pre></div>
</div>
<p>Most of the RSEs share the same set of attributes, and is possible to create RSE Expressions based on all of them.</p>
</div>
<div class="section" id="operators">
<h2>Operators<a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h2>
<p>Operators are used to connect terms in order to get more complex RSE Expressions/terms.
The syntactic functionality of the Rucio RSE Expressions Parser allows the basic operations defined in
mathematical set theory, Union, Intersection and Complement.
Using an operator on two sets of RSEs will construct a new set based on the given sets.</p>
<p>The symbols <strong>A</strong> and <strong>B</strong> in this table stand for a term.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 14%" />
<col style="width: 19%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Interpretation</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A|B</p></td>
<td><p>UNION</p></td>
<td><p>A union B</p></td>
<td><p>EELA-UNLP_SCRATCHDISK | EELA-UNLP_PRODDISK</p></td>
</tr>
<tr class="row-odd"><td><p>A&amp;B</p></td>
<td><p>INTERSECT</p></td>
<td><p>A intersect B</p></td>
<td><p>tier=1&amp;country=us</p></td>
</tr>
<tr class="row-even"><td><p>A\B</p></td>
<td><p>COMPLEMENT</p></td>
<td><p>A complement B</p></td>
<td><p>cloud=ES\type=SCRATCHDISK</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="composing-rse-expressions">
<h2>Composing RSE Expressions<a class="headerlink" href="#composing-rse-expressions" title="Permalink to this headline">¶</a></h2>
<p>Using the operators described above, it’s possible to create expressions to select whatever RSE you need to put your data in.
Use the following list of examples to build your own RSE Expressions.</p>
<p>All Tier 2 sites in DE cloud:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0100:~$ rucio list-rses --expression &#39;tier=2&amp;cloud=DE&#39;
PRAGUELCG2_PPSLOCALGROUPDISK
FMPHI-UNIBA_LOCALGROUPDISK
...
UNI-FREIBURG_DATADISK
DESY-HH_PRODDISK
</pre></div>
</div>
<p>Note the use of the single quotes. Single quotes are needed to avoid the shell interpret the <strong>&amp;</strong>, the <strong>|</strong> or the <strong>\</strong> as commands.</p>
<p>All tier 1 but not the ones in country=us:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0100:~$ rucio list-rses --expression &#39;tier=1\country=us&#39;
INFN-T1_MCTAPE
BNL-OSG2_DATATAPE
...
BNL-OSG2_DDMTEST
NIKHEF-ELPROD_PHYS-SUSY
</pre></div>
</div>
<p>However, take care of the subtle differences. While the first expression exclude United States’ sites, the second doesn’t:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0100:~$ rucio list-rses --expression &#39;tier=1\country=us&#39;|wc -l
115
jbogadog@lxplus0100:~$ rucio list-rses --expression &#39;tier=1\country=US&#39;|wc -l
117
</pre></div>
</div>
<p>The filters are processed from left to right. Is possible to use parenthesis to force the order of operation.
See the following example to get all the SCRATCHDISKs in IT or FR clouds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbogadog@lxplus0100:~$ rucio list-rses --expression &#39;cloud=IT|cloud=FR&amp;type=SCRATCHDISK&#39;|wc -l
30
jbogadog@lxplus0100:~$ rucio list-rses --expression &#39;(cloud=IT|cloud=FR)&amp;type=SCRATCHDISK&#39;|wc -l
30
jbogadog@lxplus0100:~$ rucio list-rses --expression &#39;type=SCRATCHDISK&amp;(cloud=IT|cloud=FR)&#39;|wc -l
30
jbogadog@lxplus0100:~$ rucio list-rses --expression &#39;type=SCRATCHDISK&amp;cloud=IT|cloud=FR&#39;|wc -l
92
</pre></div>
</div>
<p>While the first three operations are equivalent, the last return sites in cloud FR but not only the SCRATCHDISKs but the GROUPDISKs and DATADISKs too, among other types.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="overview_Accounting_and_quota.html" class="btn btn-neutral float-right" title="Accounting and quota" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="replication_rules_examples.html" class="btn btn-neutral float-left" title="Replication rule examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2012-2018 CERN for the benefit of the ATLAS collaboration

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>